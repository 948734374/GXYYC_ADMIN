<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="repertoryMapper" >


	<!-- 获取车辆库存  -->
	<select id="getRepertoryList" parameterType="pd" resultType="com.mcfish.entity.common.Cars">

		select
		*,
		(
			select
				count(*)
			from
				tb_dev
			<where>
				<if test="status != null and status != ''">
					status = #{status}
				</if>
			</where>
		) as total
		from
		tb_dev
		<where>
			<if test="status != null and status != ''">
				status = #{status}
			</if>
			<if test="selectStr != null and selectStr != ''">
				and(dno LIKE CONCAT('%',#{selectStr},'%')
					or shop_id LIKE CONCAT('%',#{selectStr},'%')
				)
			</if>
			<if test="startTime != null and startTime != ''">
				and date_format(create_time,'%Y-%m-%d') &gt; #{startTime}
			</if>

			<if test="endTime != null and endTime != ''">
				and date_format(create_time,'%Y-%m-%d') &lt; #{endTime}
			</if>
		</where>
		order by create_time desc
		<if test="length != null  and length!='' and length != -1">
			limit #{start},#{length}
		</if>

	</select>


	<!-- 获取车辆投放申请  -->
	<select id="getRepertoryApplyList" parameterType="pd" resultType="com.mcfish.entity.common.CarsApply">
		select
		*,
		(
		select
		count(*)
		from
		tb_dev_apply
		<where>
			<if test="status != null and status != ''">
				status = #{status}
			</if>
		</where>
		) as total
		from
		tb_dev_apply
		<where>
			<if test="status != null and status != ''">
				status = #{status}
			</if>
			<if test="selectStr != null and selectStr != ''">
				and(id LIKE CONCAT('%',#{selectStr},'%')
				or name LIKE CONCAT('%',#{selectStr},'%')
				)
			</if>
			<if test="startTime != null and startTime != ''">
				and date_format(create_time,'%Y-%m-%d') &gt; #{startTime}
			</if>

			<if test="endTime != null and endTime != ''">
				and date_format(create_time,'%Y-%m-%d') &lt; #{endTime}
			</if>
		</where>
		order by create_time desc
		<if test="length != null  and length!='' and length != -1">
			limit #{start},#{length}
		</if>

	</select>

</mapper>